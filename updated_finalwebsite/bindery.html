<!DOCTYPE html>
<html>
<head>
<title>A Generative Chapbook</title>
<!-- <link rel="stylesheet" href="styles.css"> -->
<link rel="stylesheet" href="bindery.css">
</head>
<body>
    <div id="content">
        <div id="frontPage">
            <h1 id="title">Title</h1>
            <h2 id="meta-data">Date generated</h3>
        </div>
        <div id="poemsHere">

        </div>
        <div id="backPage">
            <h1>Title</h1>
            <h3>Date generated</h3>
        </div>
    </div>

    <script src="https://unpkg.com/rita"></script>
    <script src="bindery.min.js"></script>
    <script src="poetry.js"></script>
    <script>
      let colors = [
        {coverColor: "#9EBAAF", innerColor: "#EAF5EC", accentColor: "#405A57"}, 
        {coverColor: "#9EA5BA", innerColor: "#E3E3E3", accentColor: "#587F8D"}, 
        {coverColor: "#BA9EB5", innerColor: "#F0EAF5", accentColor: "#8D5858"}, 
        {coverColor: "#BEBCA3", innerColor: "#F5F4EA", accentColor: "#8D5882"}]

      let randomColor = Math.floor(Math.random() * colors.length);

      let pageColorRule = Bindery.createRule({
          eachPage: function(page, book) {
          
          if (page.number == 1) {
              page.background.style.backgroundColor = colors[randomColor].coverColor;
        } else if (page.number % 6 == 0){
              page.background.style.backgroundColor = colors[randomColor].accentColor;
          } else {
              page.background.style.backgroundColor = colors[randomColor].innerColor;
          }
      }
  });
  
        setTimeout(function(){
        Bindery.makeBook({
          content: '#content',
          view: Bindery.View.FLIPBOOK,
          pageSetup: {
              size: {
                  width: '4in', height: '6in'
              },
              margin: {
                  top: '24pt', inner: '12pt', outer: '12pt', bottom: '12pt'
              },
          },
          
          rules: [
              pageColorRule,
              // imageBorderRule,
              Bindery.FullBleedSpread({
                  selector: '.spread',
                  continue: 'left',
              }),
              Bindery.PageBreak({
                  selector: '.break',
              }),
              Bindery.PageBreak({
                  selector: '#frontPage',
                  position: 'after'
              }),
              Bindery.RunningHeader({
                    render: (pageInfo) => pageInfo.isLeft
                    ? `${pageInfo.number} · ${pageInfo.heading.h1}`
                    : `${pageInfo.heading.h2} · ${pageInfo.number}`
              }),
                Bindery.PageBreak({ selector: '#backPage', position: 'before' }),
          ]
        }); 
        }, 5000);
        
    </script>
</body>
</html>